/* Author of the code: Angela Lee */

<script src="./product_data.js" type="text/javascript"></script>

<script>
  //Used code from lab 13 and moderated it from there
  function checkQuantityTextbox() {
    errors_array=isNonNegInt(quantity_textbox.value,true);
    qty_textbox_message.innerHTML=errors_array.join(' ');
  }

  function isNonNegInt(q,returnErrors=false) {
    errors=[];
    //Assume that there will be no errors at this point in time
    if(Number(q) != q) errors.push('Not a number!'); // Check if string is a number value
    if(q < 0) errors.push('Negative value!'); // Check if it is non-negative
    if(parseInt(q) != q) errors.push('Not an integer!'); // Check that it is an integer
    return returnErrors ? errors : (errors.length == 0);
  }

//Query string values will be for the form submission
let params=(new URL(document.location)).searchParams;
GET={};
params.forEach(function(value,key) {GET[key]=value});
</script>

<!DOCTYPE html>
<html lang="en">
<head>

<script src="./product_data.js" type="text/javascript"></script>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>La Patisserie Cakes</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Raleway" rel="stylesheet">
</head>

<header>
    <div>
        <a class="title" href="index.html">La Patisserie Cakes</a>
        <h1>Choose any cake below and purchase!</h1>
        <br>
    </div>
</header>

<body>
    <form name="quantity_form" action="/process_form" method="POST">
        <main>
            
            <script>
            //Using code from assignment 1 page
            for(i=0; i<products.length;i++) {
                document.write(`
                <section class="Patssierie">
                    <h2>${products[i]["cake"]}</h2>
                    <p>\$${products[i]["price"]}</p>
            <img class="image" src="${products[i]["image"]}">
            <br>

                <label id="quantity"}">Quantity</label>
                
                <input id="qty_textbox_message" type="text" placeholder="Enter a quantity" name="quantity${i}" onkeyup="checkQuantityTextbox(this);"> 
                
            </section>
            `);
          }
          /* Used the code from lab 13 and modified from there*/
        </script>
      </main>
    </div>
    <div id="buyButton">
      <input name="purchase_submit_button" type="submit" value="Purchase">
    </div>
  </form>
</body>
</html>